var marqdoujAzureMapsBlazor;(()=>{"use strict";var e={n:t=>{var a=t&&t.__esModule?()=>t.default:()=>t;return e.d(a,{a}),a},d:(t,a)=>{for(var o in a)e.o(a,o)&&!e.o(t,o)&&Object.defineProperty(t,o,{enumerable:!0,get:a[o]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r:e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}},t={};e.r(t),e.d(t,{Animations:()=>X,Configurations:()=>Y,Controls:()=>ee,Events:()=>te,Features:()=>ae,Geolocations:()=>oe,ImageSprites:()=>re,Layers:()=>ne,MapFactory:()=>Q,Markers:()=>se,Mercators:()=>ie,Popups:()=>ce,Sources:()=>le});const a=atlas;var o,r,n,s,i,c,l,d,p,u,g,v,m,y,f,h,M,E,I,b,S=e.n(a);class k{static parseJsonString(e){return JSON.parse(e)}static isEmptyOrNull(e){return null==e||""===e.trim()}static isNotEmptyOrNull(e){return!this.isEmptyOrNull(e)}static isValueInEnum(e,t){return Object.values(e).includes(t)}static isJsInteropDef(e){return e&&null!=e.jsInterop&&1==e.jsInterop.isMarqdouj}static getJsInteropDef(e){return this.isJsInteropDef(e)?e.jsInterop:void 0}static isFeature(e){return e&&"Feature"===e.type}static isShape(e){return e&&null!=e.getType}static getFeatureResult(e){return{jsInterop:this.getJsInteropDef(e),id:e.id?.toString(),type:e.geometry.type,bbox:e.bbox,source:"feature",properties:e.properties}}static getShapeResult(e){return{jsInterop:this.getJsInteropDef(e),id:e.getId()?.toString(),type:e.getType(),bbox:e.getBounds(),source:"shape",properties:e.getProperties()}}static buildShapeResults(e){const t=[];return e.filter(e=>this.isFeature(e)).forEach(e=>{t.push(this.getFeatureResult(e))}),e.filter(e=>this.isShape(e)).forEach(e=>{t.push(this.getShapeResult(e))}),t}}!function(e){e[e.Trace=0]="Trace",e[e.Debug=1]="Debug",e[e.Information=2]="Information",e[e.Warn=3]="Warn",e[e.Error=4]="Error",e[e.Critical=5]="Critical",e[e.None=6]="None"}(o||(o={}));class C{static currentLevel=o.Information;static GetMapHeader(e){return`Map with Id '${e}'`}static logMessage(e,t,a,...r){if(t<this.currentLevel)return;const n=`${this.GetMapHeader(e)} [${C.#e(t)}] ${a}`;switch(t){case o.Trace:console.trace(n,...r);break;case o.Debug:console.debug(n,...r);break;case o.Information:console.info(n,...r);break;case o.Warn:console.warn(n,...r);break;case o.Error:console.error(n,...r);break;case o.Critical:console.error(`CRITICAL: ${n}`,...r)}}static#e(e){switch(e){case o.Critical:return"Critical";case o.Debug:return"Debug";case o.Error:return"Error";case o.Information:return"Information";case o.None:return"None";case o.Trace:return"Trace";case o.Warn:return"Warn"}}}class D{#t=new Map;mapId;constructor(e){this.mapId=e}addCallback(e,t){const a=this.#a(e);this.#t.has(a)||(this.#t.set(a,t),C.logMessage(this.mapId,o.Trace,"EventsMap-addCallback:",a))}getCallback(e,t){const a=this.#a(e);if(this.#t.has(a)){const e=this.#t.get(a);if(t){const e=this.#t.delete(a);C.logMessage(this.mapId,o.Trace,"EventsMap-removeCallback:",a,e)}return e}}#a(e){return`${e.target}.${e.type}.${e.targetId}`}clear(){this.#t.clear()}}class N{#o;#r;#n;#t;constructor(e,t,a){this.#o=e,this.#n=t,this.#r=a,this.#t=new D(t)}get dotNetRef(){return this.#o}get eventsMap(){return this.#t}get mapId(){return this.#n}get map(){return this.#r}clear(){this.#o=null,this.#n=null,this.#r=null}}class w{static logEventAdd(e,t,a,r){a?C.logMessage(e,o.Trace,`${t}: event added:`,r):C.logMessage(e,o.Error,`${t}: event not supported:`,r)}static logEventRemoved(e,t,a,r){a?C.logMessage(e,o.Trace,`${t}: event removed:`,r):C.logMessage(e,o.Error,`${t}: event not supported:`,r)}static logInvalidTargetId(e,t,a){C.logMessage(e,o.Error,`${t}: 'once' is not supported:`,a),C.logMessage(e,o.Error,`${t}: invalid TargetId.`,a)}static logOnceNotSupported(e,t,a){C.logMessage(e,o.Error,`${t}: 'once' is not supported:`,a)}static logNotifyFired(e,t,...a){C.logMessage(e,o.Trace,`${t}: event was fired.`,a)}static logMessage(e,t,a,...o){C.logMessage(e,t,a,o)}}class R{static buildKeyboardEventPayload(e){return{keyboard:{key:e.key,code:e.code,location:e.location,repeat:e.repeat,altKey:e.altKey,ctrlKey:e.ctrlKey,shiftKey:e.shiftKey,metaKey:e.metaKey}}}static buildMapEventArgs(e,t,a,o){return{mapId:e,type:t.type,target:t.target,targetId:t?.targetId,payload:{jsInterop:k.getJsInteropDef(o),...a}}}static buildLayerEventPayload(e){return{layer:{id:e.getId()}}}static buildShapeResults(e){const t=[];return e.filter(e=>k.isFeature(e)).forEach(e=>{t.push(k.getFeatureResult(e))}),e.filter(e=>k.isShape(e)).forEach(e=>{t.push(k.getShapeResult(e))}),t}static buildMouseEventPayload(e){return{mouse:{layerId:e.layerId,pixel:e.pixel,position:e.position,shapes:this.buildShapeResults(e.shapes)}}}static buildTouchEventPayload(e){return{touch:{pixel:e.pixel,pixels:e.pixels,position:e.position,positions:e.positions,layerId:e.layerId,shapes:this.buildShapeResults(e.shapes)}}}static buildWheelEventPayload(e){return{wheel:{type:e.type}}}}class O{add(e,t,a){0!=t.length&&this.#s(e,this.#i(t),a)}remove(e,t,a){0!=t.length&&this.#c(e,this.#i(t),a)}#i(e){return Object.values(e).filter(e=>"layer"===e.target&&k.isValueInEnum(r,e.type))}#s(e,t,a){if(0==t.length)return;const o="addLayerEvents",r=e.map;t.forEach(t=>{let n=!1;const s=a??this.#l(r,t);if(a&&(t.targetId=a.getId()),!s)return void w.logInvalidTargetId(e.mapId,o,t);const i=this.#d(e,t,!1);i&&s&&(t.once?r.events.addOnce(t.type,s,i):r.events.add(t.type,s,i),n=!0),w.logEventAdd(e.mapId,o,n,t)})}#c(e,t,a){if(0==t.length)return;const o="removeLayerEvents",r=e.map;t.forEach(t=>{let n=!1;const s=a??this.#l(r,t);if(a&&(t.targetId=a.getId()),!s)return void w.logInvalidTargetId(e.mapId,o,t);const i=this.#d(e,t,!0);i&&(s?(r.events.remove(t.type,s,i),n=!0):w.logInvalidTargetId(e.mapId,o,t)),w.logEventRemoved(e.mapId,o,n,t)})}#l(e,t){if("layer"===t.target)return e.layers.getLayerById(t.targetId)}#d(e,t,a){let o=e.eventsMap.getCallback(t,a);if(o)return o;switch(t.type){case r.LayerAdded:case r.LayerRemoved:o=a=>this.#p(a,e,t);break;case r.Click:case r.ContextMenu:case r.DblClick:case r.MouseDown:case r.MouseEnter:case r.MouseLeave:case r.MouseMove:case r.MouseOut:case r.MouseOver:case r.MouseUp:o=a=>this.#u(a,e,t);break;case r.TouchCancel:case r.TouchEnd:case r.TouchMove:case r.TouchStart:o=o=a=>this.#g(a,e,t);break;case r.Wheel:o=a=>this.#v(a,e,t)}return e.eventsMap.addCallback(t,o),o}#p=(e,t,a)=>{let o=R.buildMapEventArgs(t.mapId,a,R.buildLayerEventPayload(e),e);t.dotNetRef.invokeMethodAsync(y.NotifyMapEvent,o),w.logNotifyFired(t.mapId,y.NotifyMapEvent,a.type)};#g=(e,t,a)=>{a.preventDefault&&e.preventDefault();let o=R.buildMapEventArgs(t.mapId,a,R.buildTouchEventPayload(e));t.dotNetRef.invokeMethodAsync(y.NotifyMapEvent,o),w.logNotifyFired(t.mapId,y.NotifyMapEvent,a.type)};#u=(e,t,a)=>{a.preventDefault&&e.preventDefault();let o=R.buildMapEventArgs(t.mapId,a,R.buildMouseEventPayload(e));t.dotNetRef.invokeMethodAsync(y.NotifyMapEvent,o),w.logNotifyFired(t.mapId,y.NotifyMapEvent,a.type)};#v=(e,t,a)=>{a.preventDefault&&e.preventDefault();let o=R.buildMapEventArgs(t.mapId,a,R.buildWheelEventPayload(e));t.dotNetRef.invokeMethodAsync(y.NotifyMapEvent,o),w.logNotifyFired(t.mapId,y.NotifyMapEvent,a.type)}}!function(e){e.LayerAdded="layeradded",e.LayerRemoved="layerremoved",e.Click="click",e.ContextMenu="contextmenu",e.DblClick="dblclick",e.MouseDown="mousedown",e.MouseEnter="mouseenter",e.MouseLeave="mouseleave",e.MouseMove="mousemove",e.MouseOut="mouseout",e.MouseOver="mouseover",e.MouseUp="mouseup",e.TouchCancel="touchcancel",e.TouchEnd="touchend",e.TouchMove="touchmove",e.TouchStart="touchstart",e.Wheel="wheel"}(r||(r={}));class T{static add(e,t,a){const o=V.getMapReference(e);o&&(t??=[],t.forEach(t=>{let r={...t.options};r.popup&&(r.popup=new(S().Popup)(r.popup.options));let n=new(S().HtmlMarker)(r);n.jsInterop=t.jsInterop,o.map.markers.add(n),a&&(a.forEach(e=>{e.targetId=t.id}),U.add(e,a)),t.togglePopupOnClick&&o.map.events.add("click",n,()=>{n.togglePopup()})}))}static remove(e,t){const a=V.getMapReference(e);a&&t.forEach(e=>{let t=T.#m(a,e.id);t&&a.map.markers.remove(t)})}static getMarker(e,t){const a=V.getMapReference(e);if(a)return T.#m(a,t)}static#m(e,t){const a=e.map.markers.getMarkers().findLast(e=>T.#y(e,t));return a||C.logMessage(e.mapId,o.Debug,`getMarker: marker not found where id = '${t}'`),a}static#y(e,t){const a=k.getJsInteropDef(e);return e instanceof S().HtmlMarker&&null!=a&&a.id===t}}class A{add(e,t){0!=t.length&&this.#f(e,this.#i(t))}remove(e,t){0!=t.length&&this.#h(e,this.#i(t))}#i(e){return Object.values(e).filter(e=>"htmlmarker"===e.target&&k.isValueInEnum(n,e.type))}#f(e,t){if(0==t.length)return;const a="addHtmlMarkerEvents";t.forEach(t=>{const o=this.#l(e,t);let r=!1;if(o){const s=t.type,i=this.#d(e,t,!1);if(i)switch(s){case n.KeyDown:case n.KeyPress:case n.KeyUp:const a=o.getElement();a&&(a.tabIndex=0,a.addEventListener(s,i),r=!0);break;default:t.once?e.map.events.addOnce(s,o,i):e.map.events.add(s,o,i),r=!0}w.logEventAdd(e.mapId,a,r,t)}else w.logInvalidTargetId(e.mapId,a,t)})}#h(e,t){if(0==t.length)return;const a="removeHtmlMarkerEvents";t.forEach(t=>{const o=this.#l(e,t);let r=!1;if(o){const s=this.#d(e,t,!0);if(s){const a=t.type;switch(a){case n.KeyDown:case n.KeyPress:case n.KeyUp:const r=o.getElement();r&&r.removeEventListener(a,s);break;default:e.map.events.remove(t.type,o,s)}r=!0}w.logEventRemoved(e.mapId,a,r,t)}else w.logInvalidTargetId(e.mapId,a,t)})}#d(e,t,a){let o=e.eventsMap.getCallback(t,a);if(o)return o;switch(t.type){case n.KeyDown:case n.KeyPress:case n.KeyUp:o=a=>this.#M(a,e,t);break;default:o=a=>this.#E(a,e,t)}return e.eventsMap.addCallback(t,o),o}#l(e,t){return T.getMarker(e.mapId,t.targetId)}#E=(e,t,a)=>{let o=R.buildMapEventArgs(t.mapId,a,{htmlMarker:{type:e.type}});t.dotNetRef.invokeMethodAsync(y.NotifyMapEvent,o),w.logNotifyFired(t.mapId,y.NotifyMapEvent,a.type)};#M=(e,t,a)=>{a.preventDefault&&e.preventDefault();let o=R.buildMapEventArgs(t.mapId,a,{htmlMarker:{type:e.type,...R.buildKeyboardEventPayload(e)}});t.dotNetRef.invokeMethodAsync(y.NotifyMapEvent,o),w.logNotifyFired(t.mapId,y.NotifyMapEvent,a.type)}}!function(e){e.Click="click",e.ContextMenu="contextmenu",e.DblClick="dblclick",e.MouseDown="mousedown",e.MouseEnter="mouseenter",e.MouseLeave="mouseleave",e.MouseMove="mousemove",e.MouseOut="mouseout",e.MouseOver="mouseover",e.MouseUp="mouseup",e.Drag="drag",e.DragEnd="dragend",e.DragStart="dragstart",e.KeyDown="keydown",e.KeyPress="keypress",e.KeyUp="keyup"}(n||(n={}));class P{add(e,t){0!=t.length&&this.#I(e,this.#i(t))}remove(e,t){0!=t.length&&this.#b(e,this.#i(t))}#i(e){return Object.values(e).filter(e=>"map"===e.target)}#I(e,t){0!=t.length&&(this.#S(e,t),this.#k(e,t),this.#C(e,t),this.#D(e,t),this.#N(e,t),this.#w(e,t),this.#R(e,t),this.#O(e,t),this.#T(e,t))}#b(e,t){0!=t.length&&(this.#A(e,t),this.#P(e,t),this.#L(e,t),this.#j(e,t),this.#W(e,t),this.#$(e,t),this.#x(e,t),this.#B(e,t),this.#F(e,t))}#S(e,t){if(0==t.length)return;const a="addMapEventConfig";Object.values(t).filter(e=>k.isValueInEnum(s,e.type)).forEach(t=>{let o=!1;const r=this.#G(e,t,!1);r&&(t.once?w.logOnceNotSupported(e.mapId,a,t):(e.map.events.add(t.type,r),o=!0)),w.logEventAdd(e.mapId,a,o,t)})}#A(e,t){0!=t.length&&Object.values(t).filter(e=>k.isValueInEnum(s,e.type)).forEach(t=>{let a=!1;const o=this.#G(e,t,!0);o&&(e.map.events.remove(t.type,o),a=!0),w.logEventRemoved(e.mapId,"removeMapEventConfig",a,t)})}#G(e,t,a){let o=e.eventsMap.getCallback(t,a);return o||(o=a=>this.#U(a,e,t),e.eventsMap.addCallback(t,o),o)}#U=(e,t,a)=>{const o=R.buildMapEventArgs(t.mapId,a,{config:{...e}});t.dotNetRef.invokeMethodAsync(y.NotifyMapEvent,o),w.logNotifyFired(t.mapId,y.NotifyMapEvent,a.type)};#k(e,t){0!=t.length&&Object.values(t).filter(e=>k.isValueInEnum(i,e.type)).forEach(t=>{let a=!1;const o=this.#V(e,t,!1);o&&(t.once?e.map.events.addOnce(t.type,o):e.map.events.add(t.type,o),a=!0),w.logEventAdd(e.mapId,"addMapEventData",a,t)})}#P(e,t){0!=t.length&&Object.values(t).filter(e=>k.isValueInEnum(i,e.type)).forEach(t=>{let a=!1;const o=this.#V(e,t,!0);o&&(e.map.events.remove(t.type,o),a=!0),w.logEventRemoved(e.mapId,"removeMapEventData",a,t)})}#V(e,t,a){let o=e.eventsMap.getCallback(t,a);return o||(o=a=>this.#K(a,e,t),e.eventsMap.addCallback(t,o),o)}#K=(e,t,a)=>{let o=R.buildMapEventArgs(t.mapId,a,this.#z(e));t.dotNetRef.invokeMethodAsync(y.NotifyMapEvent,o),w.logNotifyFired(t.mapId,y.NotifyMapEvent,a.type)};#z(e){return{data:{dataType:e.dataType,isSourceLoaded:e.isSourceLoaded,source:e.source?.getId(),sourceDataType:e.sourceDataType,tile:e.tile}}}#C(e,t){0!=t.length&&Object.values(t).filter(e=>k.isValueInEnum(c,e.type)).forEach(t=>{let a=!1;const o=this.#H(e,t,!1);o&&(t.once?e.map.events.addOnce(t.type,o):e.map.events.add(t.type,o),a=!0),w.logEventAdd(e.mapId,"addMapEventGeneral",a,t)})}#L(e,t){0!=t.length&&Object.values(t).filter(e=>k.isValueInEnum(c,e.type)).forEach(t=>{let a=!1;const o=this.#H(e,t,!0);o&&(e.map.events.remove(t.type,o),a=!0),w.logEventRemoved(e.mapId,"removeMapEventGeneral",a,t)})}#H(e,t,a){let o=e.eventsMap.getCallback(t,a);return o||(o=a=>{this.#J(a,e,t)},e.eventsMap.addCallback(t,o),o)}#J=(e,t,a)=>{let o=R.buildMapEventArgs(t.mapId,a);t.dotNetRef.invokeMethodAsync(y.NotifyMapEvent,o),w.logNotifyFired(t.mapId,y.NotifyMapEvent,a.type)};#D(e,t){0!=t.length&&Object.values(t).filter(e=>k.isValueInEnum(l,e.type)).forEach(t=>{let a=!1;const o=this.#Z(e,t,!1);o&&(t.once?e.map.events.addOnce(t.type,o):e.map.events.add(t.type,o),a=!0),w.logEventAdd(e.mapId,"addMapEventLayer",a,t)})}#j(e,t){0!=t.length&&Object.values(t).filter(e=>k.isValueInEnum(l,e.type)).forEach(t=>{let a=!1;const o=this.#Z(e,t,!0);o&&(e.map.events.remove(t.type,o),a=!0),w.logEventRemoved(e.mapId,"removeMapEventLayer",a,t)})}#Z(e,t,a){let o=e.eventsMap.getCallback(t,a);return o||(o=a=>{this.#p(a,e,t)},e.eventsMap.addCallback(t,o),o)}#p=(e,t,a)=>{let o=R.buildMapEventArgs(t.mapId,a,R.buildLayerEventPayload(e),e);t.dotNetRef.invokeMethodAsync(y.NotifyMapEvent,o),w.logNotifyFired(t.mapId,y.NotifyMapEvent,a.type)};#N(e,t){0!=t.length&&Object.values(t).filter(e=>k.isValueInEnum(f,e.type)).forEach(t=>{let a=!1,o=this.#_(e,t,!1);o&&(t.once?e.map.events.addOnce(t.type,o):e.map.events.add(t.type,o),a=!0),w.logEventAdd(e.mapId,"addMapEventMouse",a,t)})}#W(e,t){0!=t.length&&Object.values(t).filter(e=>k.isValueInEnum(f,e.type)).forEach(t=>{let a=!1,o=this.#_(e,t,!0);o&&(e.map.events.remove(t.type,o),a=!0),w.logEventRemoved(e.mapId,"removeMapEventMouse",a,t)})}#_(e,t,a){let o=e.eventsMap.getCallback(t,a);return o||(o=a=>this.#q(a,e,t),e.eventsMap.addCallback(t,o),o)}#q=(e,t,a)=>{a.preventDefault&&e.preventDefault();let o=R.buildMapEventArgs(t.mapId,a,R.buildMouseEventPayload(e));t.dotNetRef.invokeMethodAsync(y.NotifyMapEvent,o),w.logNotifyFired(t.mapId,y.NotifyMapEvent,a.type)};#w(e,t){0!=t.length&&Object.values(t).filter(e=>k.isValueInEnum(d,e.type)).forEach(t=>{let a=!1;const o=this.#Q(e,t,!1);o&&(t.once?e.map.events.addOnce(t.type,o):e.map.events.add(t.type,o),a=!0),w.logEventAdd(e.mapId,"addMapEventSource",a,t)})}#$(e,t){0!=t.length&&Object.values(t).filter(e=>k.isValueInEnum(d,e.type)).forEach(t=>{let a=!1;const o=this.#Q(e,t,!0);o&&(e.map.events.remove(t.type,o),a=!0),w.logEventRemoved(e.mapId,"removeMapEventSource",a,t)})}#Q(e,t,a){let o=e.eventsMap.getCallback(t,a);return o||(o=a=>this.#X(a,e,t),e.eventsMap.addCallback(t,o),o)}#X(e,t,a){e.getId();let o=R.buildMapEventArgs(t.mapId,a,{source:{id:e.getId()}},e);t.dotNetRef.invokeMethodAsync(y.NotifyMapEvent,o),w.logNotifyFired(t.mapId,y.NotifyMapEvent,a.type)}#R(e,t){0!=t.length&&Object.values(t).filter(e=>k.isValueInEnum(p,e.type)).forEach(t=>{let a=!1;const o=this.#Y(e,t,!1);o&&(t.once?e.map.events.addOnce(t.type,o):e.map.events.add(t.type,o),a=!0),w.logEventAdd(e.mapId,"addMapEventStyle",a,t)})}#x(e,t){0!=t.length&&Object.values(t).filter(e=>k.isValueInEnum(p,e.type)).forEach(t=>{let a=!1;const o=this.#Y(e,t,!0);o&&(e.map.events.remove(t.type,o),a=!0),w.logEventRemoved(e.mapId,"removeMapEventStyle",a,t)})}#Y(e,t,a){let o=e.eventsMap.getCallback(t,a);if(o)return o;switch(t.type.toLowerCase()){case p.StyleChanged:o=a=>this.#ee(a.style,e,t);break;case p.StyleImageMissing:o=a=>this.#ee(a,e,t)}return e.eventsMap.addCallback(t,o),o}#ee(e,t,a){let o=R.buildMapEventArgs(t.mapId,a,{style:{style:e}});t.dotNetRef.invokeMethodAsync(y.NotifyMapEvent,o),w.logNotifyFired(t.mapId,y.NotifyMapEvent,a.type)}#O(e,t){0!=t.length&&Object.values(t).filter(e=>k.isValueInEnum(h,e.type)).forEach(t=>{let a=!1;const o=this.#te(e,t,!1);o&&(t.once?e.map.events.addOnce(t.type,o):e.map.events.add(t.type,o),a=!0),w.logEventAdd(e.mapId,"addMapEventTouch",a,t)})}#B(e,t){0!=t.length&&Object.values(t).filter(e=>k.isValueInEnum(h,e.type)).forEach(t=>{let a=!1;const o=this.#te(e,t,!0);o&&(e.map.events.remove(t.type,o),a=!0),w.logEventRemoved(e.mapId,"removeMapEventTouch",a,t)})}#te(e,t,a){let o=e.eventsMap.getCallback(t,a);return o||(o=a=>this.#ae(a,e,t),e.eventsMap.addCallback(t,o),o)}#ae=(e,t,a)=>{a.preventDefault&&e.preventDefault();let o=R.buildMapEventArgs(t.mapId,a,R.buildTouchEventPayload(e));t.dotNetRef.invokeMethodAsync(y.NotifyMapEvent,o),w.logNotifyFired(t.mapId,y.NotifyMapEvent,a.type)};#T(e,t){0!=t.length&&Object.values(t).filter(e=>k.isValueInEnum(M,e.type)).forEach(t=>{let a=!1,o=this.#oe(e,t,!1);o&&(t.once?e.map.events.addOnce(t.type,o):e.map.events.add(t.type,o),a=!0),w.logEventAdd(e.mapId,"addMapEventWheel",a,t)})}#F(e,t){0!=t.length&&Object.values(t).filter(e=>k.isValueInEnum(M,e.type)).forEach(t=>{let a=!1,o=this.#oe(e,t,!0);o&&(e.map.events.remove(t.type,o),a=!0),w.logEventRemoved(e.mapId,"removeMapEventWheel",a,t)})}#oe(e,t,a){let o=e.eventsMap.getCallback(t,a);return o||(o=a=>this.#re(a,e,t),e.eventsMap.addCallback(t,o),o)}#re=(e,t,a)=>{a.preventDefault&&e.preventDefault();let o=R.buildMapEventArgs(t.mapId,a,R.buildWheelEventPayload(e));t.dotNetRef.invokeMethodAsync(y.NotifyMapEvent,o),w.logNotifyFired(t.mapId,y.NotifyMapEvent,a.type)}}!function(e){e.MapConfigChanged="mapconfigurationchanged"}(s||(s={})),function(e){e.Data="data",e.SourceData="sourcedata",e.StyleData="styledata"}(i||(i={})),function(e){e.BoxZoomEnd="boxzoomend",e.BoxZoomStart="boxzoomstart",e.Drag="drag",e.DragEnd="dragend",e.DragStart="dragstart",e.Idle="idle",e.Load="load",e.Move="move",e.MoveEnd="moveend",e.MoveStart="movestart",e.Pitch="pitch",e.PitchEnd="pitchend",e.PitchStart="pitchstart",e.Render="render",e.Resize="resize",e.Rotate="rotate",e.RotateEnd="rotateend",e.RotateStart="rotatestart",e.TokenAcquired="tokenacquired",e.Zoom="zoom",e.ZoomEnd="zoomend",e.ZoomStart="zoomstart"}(c||(c={})),function(e){e.LayerAdded="layeradded",e.LayerRemoved="layerremoved"}(l||(l={})),function(e){e.SourceAdded="sourceadded",e.SourceRemoved="sourceremoved"}(d||(d={})),function(e){e.StyleChanged="stylechanged",e.StyleImageMissing="styleimagemissing"}(p||(p={}));class L{static add(e,t){const a=V.getMapReference(e);a&&(t??=[],t.forEach(e=>{let t=new(S().Popup)(e.options);t.jsInterop=k.getJsInteropDef(t),a.map.popups.add(t)}))}static remove(e,t){const a=V.getMapReference(e);a&&t.forEach(e=>{let t=L.#ne(a,e.id);t&&a.map.popups.remove(t)})}static getPopup(e,t){return L.#ne(e,t)}static#ne(e,t){const a=e.map.popups.getPopups().findLast(e=>L.#se(e,t));return a||C.logMessage(e.mapId,o.Debug,`getPopup: popup not found where id = '${t}'`),a}static#se(e,t){const a=k.getJsInteropDef(e);return e instanceof S().Popup&&null!=a&&a.id===t}}class j{add(e,t){0!=t.length&&this.#ie(e,this.#i(t))}remove(e,t){0!=t.length&&this.#ce(e,this.#i(t))}#i(e){return Object.values(e).filter(e=>"popup"===e.target&&k.isValueInEnum(u,e.type))}#ie(e,t){if(0==t.length)return;const a="addPopupEvents";t.forEach(t=>{const o=this.#l(e,t);let r=!1;if(o){const n=this.#d(e,t,!1);n&&(t.once?e.map.events.addOnce(t.type,o,n):e.map.events.add(t.type,o,n),r=!0),w.logEventAdd(e.mapId,a,r,t)}else w.logInvalidTargetId(e.mapId,a,t)})}#ce(e,t){if(0==t.length)return;const a="removePopupEvents";t.forEach(t=>{const o=this.#l(e,t);let r=!1;if(o){const n=this.#d(e,t,!0);n&&(e.map.events.remove(t.type,o,n),r=!0),w.logEventRemoved(e.mapId,a,r,t)}else w.logInvalidTargetId(e.mapId,a,t)})}#d(e,t,a){let o=e.eventsMap.getCallback(t,a);return o||(o=a=>this.#le(a,e,t),e.eventsMap.addCallback(t,o),o)}#l(e,t){return L.getPopup(e,t.targetId)}#le=(e,t,a)=>{let o=R.buildMapEventArgs(t.mapId,a,{popup:{type:e.type}});t.dotNetRef.invokeMethodAsync(y.NotifyMapEvent,o),w.logNotifyFired(t.mapId,y.NotifyMapEvent,a.type)}}!function(e){e.Drag="drag",e.DragEnd="dragend",e.DragStart="dragstart",e.Open="open",e.Close="close"}(u||(u={}));class W{static add(e,t,a){const o=V.getMapReference(e);o&&(t??=[],t.forEach(e=>{W.#de(o,e,a)}))}static#de(e,t,a){"DataSource"===t.type?W.#pe(e,t,a):C.logMessage(e.mapId,o.Warn,`add: unsupported source type: ${t.type}`)}static#pe(e,t,a){if(k.isEmptyOrNull(t.id))return void C.logMessage(e.mapId,o.Error,"addDataSource: missing Id.",t);if(e.map.sources.getById(t.id))return void C.logMessage(e.mapId,o.Warn,`addDataSource: source with ID '${t.id}' already exists.`);const r=new(S().source.DataSource)(t.id,t.options);r.jsInterop=t.jsInterop,a&&U.sources.add(e,a,r),e.map.sources.add(r),t.url&&r.importDataFromUrl(t.url)}static remove(e,t){const a=V.getMapReference(e);if(!a)return;const o=[];t.forEach(e=>{o.push(e.id)}),W.#ue(a,o)}static removeById(e,t){if(0==t.length)return;const a=V.getMapReference(e);a&&W.#ue(a,t)}static#ue(e,t){t.forEach(t=>{const a=e.map.sources.getById(t);a?(e.map.sources.remove(a),C.logMessage(e.mapId,o.Debug,`remove: source with ID '${t}' was removed.`)):C.logMessage(e.mapId,o.Warn,`remove: source with ID '${t}' was not found.`)})}static clear(e,t){const a=V.getMapReference(e);if(!a)return;const o=[];t.forEach(e=>{o.push(e.id)}),W.#ge(a,o)}static clearById(e,t){const a=V.getMapReference(e);a&&W.#ge(a,t)}static#ge(e,t){t.forEach(t=>{const a=e.map.sources.getById(t);a?null!=a.clear?(a.clear(),C.logMessage(e.mapId,o.Debug,`clear: source with ID '${t}' was cleared.`)):C.logMessage(e.mapId,o.Warn,`clear: source with ID '${t}' does not support 'clear'.`):C.logMessage(e.mapId,o.Warn,`clear: source with ID '${t}' was not found.`)})}static getShapes(e,t){const a=V.getMapReference(e);if(!a)return;const r=$.getSource(a,t);return r&&(r instanceof S().source.DataSource?k.buildShapeResults(r.getShapes()):C.logMessage(e,o.Warn,`getShapes: source with ID '${t}' does not support 'getShapes'.`)),[]}}class ${static getSource(e,t,a=!0){const r=e.map.sources.getById(t);return!r&&a&&C.logMessage(e.mapId,o.Warn,`get: source with ID '${t}' was not found.`),r}static getDataSource(e,t,a=o.Error){const r=$.getSource(e,t);if(r){if($.isDataSource(r))return r;C.logMessage(e.mapId,a,`getDataSource: source with ID '${t}' is not a DataSource`)}}static isDataSource(e){return e&&e instanceof S().source.DataSource}}class x{add(e,t,a){if(0==t.length)return;if(a&&!$.isDataSource(a))return void w.logMessage(e.mapId,o.Error,"SourceEvents: Unsupported source type for adding events.",a);const r=this.#i(t);0!=r.length&&this.#ve(e,a,r)}remove(e,t,a){if(0==t.length)return;if(a&&!$.isDataSource(a))return void w.logMessage(e.mapId,o.Error,"SourceEvents: Unsupported source type for removing events.",a);const r=this.#i(t);0!=r.length&&this.#me(e,a,r)}#i(e){return Object.values(e).filter(e=>"datasource"===e.target&&k.isValueInEnum(g,e.type))}#ve(e,t,a){if(0==a.length)return;const o=e.map,r="addDataSourceEvents";a.forEach(a=>{const n=t??this.#ye(e,a);let s=!1;if(t&&(a.targetId=t.getId()),n){const t=this.#d(e,a,!1);t&&(a.once?o.events.addOnce(a.type,n,t):o.events.add(a.type,n,t),s=!0),w.logEventAdd(e.mapId,r,s,a)}else w.logInvalidTargetId(e.mapId,r,a)})}#me(e,t,a){if(0==a.length)return;const o=e.map,r="removeDataSourceEvents";a.forEach(a=>{const n=t??this.#ye(e,a);let s=!1;if(t&&(a.targetId=t.getId()),n){const t=this.#d(e,a,!0);t&&(o.events.remove(a.type,n,t),s=!0),w.logEventRemoved(e.mapId,r,s,a)}else w.logInvalidTargetId(e.mapId,r,a)})}#d(e,t,a){let o=e.eventsMap.getCallback(t,a);return o||(o=t.type.toLowerCase()===g.DataSourceUpdated?a=>this.#fe(a,e,t):a=>this.#he(a,e,t),e.eventsMap.addCallback(t,o),o)}#ye(e,t){const o=$.getSource(e,t.targetId);if(o instanceof a.source.DataSource)return o}#fe=(e,t,a)=>{let o=R.buildMapEventArgs(t.mapId,a,{dataSource:{id:e.getId()}},e);t.dotNetRef.invokeMethodAsync(y.NotifyMapEvent,o),w.logNotifyFired(t.mapId,y.NotifyMapEvent,a.type)};#he=(e,t,a)=>{let o={dataSource:{shapes:k.buildShapeResults(e)}},r=R.buildMapEventArgs(t.mapId,a,o);t.dotNetRef.invokeMethodAsync(y.NotifyMapEvent,r),w.logNotifyFired(t.mapId,y.NotifyMapEvent,a.type,r)}}!function(e){e.DataSourceUpdated="datasourceupdated",e.DataAdded="dataadded",e.DataRemoved="dataremoved"}(g||(g={}));class B{static add(e,t){const r=V.getMap(e);r&&(t??=[],t.forEach(t=>{let n=null;switch(t.type.toLowerCase()){case"compass":n=new a.control.CompassControl(t.options);break;case"fullscreen":n=new a.control.FullscreenControl(t.options);break;case"pitch":n=new a.control.PitchControl(t.options);break;case"scale":n=new a.control.ScaleControl(t.options);break;case"style":n=new a.control.StyleControl(t.options);break;case"traffic":n=new a.control.TrafficControl(t.options);break;case"trafficlegend":n=new a.control.TrafficLegendControl;break;case"zoom":n=new a.control.ZoomControl(t.options);break;default:C.logMessage(e,o.Warn,`addControls: control type '${t.type}' is not supported.`)}n&&(n.jsInterop=t.jsInterop,r.controls.add(n,t.controlOptions))}))}static remove(e,t){const a=V.getMap(e);if(!a)return;const o=a.controls.getControls();t.forEach(t=>{let r=B.#Me(o,e,t.id);r&&a.controls.remove(r)})}static getControl(e,t){const a=V.getMap(e);if(!a)return;const o=a.controls.getControls();return B.#Me(o,e,t)}static#Me(e,t,a){const r=e.findLast(e=>B.#Ee(e,a));return r||C.logMessage(t,o.Debug,`getControl: control not found where id = '${a}'`),r}static#Ee(e,t){const a=k.getJsInteropDef(e);return e&&null!=a&&a.id===t}}class F{add(e,t){0!=t.length&&this.#Ie(e,this.#i(t))}remove(e,t){0!=t.length&&this.#be(e,this.#i(t))}#i(e){return Object.values(e).filter(e=>"stylecontrol"===e.target&&k.isValueInEnum(v,e.type))}#Ie(e,t){if(0==t.length)return;const a="addStyleControlEvents";t.forEach(t=>{const o=B.getControl(e.mapId,t.targetId);if(o instanceof S().control.StyleControl){let r=!1;const n=this.#d(e,t,!1);n&&(t.once?e.map.events.addOnce(t.type,o,n):e.map.events.add(t.type,o,n),r=!0),w.logEventAdd(e.mapId,a,r,t)}else w.logInvalidTargetId(e.mapId,a,t)})}#be(e,t){if(0==t.length)return;const a="removeStyleControlEvents";t.forEach(t=>{const o=B.getControl(e.mapId,t.targetId);if(o instanceof S().control.StyleControl){let r=!1;const n=this.#d(e,t,!0);n&&(e.map.events.remove(t.type,o,n),r=!0),w.logEventRemoved(e.mapId,a,r,t)}else w.logInvalidTargetId(e.mapId,a,t)})}#d(e,t,a){let o=e.eventsMap.getCallback(t,a);return o||(o=a=>this.#Se(a,e,t),e.eventsMap.addCallback(t,o),o)}#Se=(e,t,a)=>{let o=R.buildMapEventArgs(t.mapId,a,{styleControl:{style:e}});t.dotNetRef.invokeMethodAsync(y.NotifyMapEvent,o),w.logNotifyFired(t.mapId,y.NotifyMapEvent,a.type)}}!function(e){e.StyleSelected="styleselected"}(v||(v={}));class G{add(e,t){0!=t.length&&this.#ke(e,this.#i(t))}remove(e,t){0!=t.length&&this.#Ce(e,this.#i(t))}#i(e){return Object.values(e).filter(e=>"shape"===e.target&&k.isValueInEnum(m,e.type))}#ke(e,t){if(0==t.length)return;const a="addShapeEvents";t.forEach(t=>{const o=this.#l(e,t);let r=!1;if(o){const n=this.#d(e,t,!1);n&&(t.once?e.map.events.addOnce(t.type,o,n):e.map.events.add(t.type,o,n),r=!0),w.logEventAdd(e.mapId,a,r,t)}else w.logInvalidTargetId(e.mapId,a,t)})}#Ce(e,t){if(0==t.length)return;const a="removeShapeEvents";t.forEach(t=>{const o=this.#l(e,t);let r=!1;if(o){const n=this.#d(e,t,!0);n&&(e.map.events.remove(t.type,o,n),r=!0),w.logEventRemoved(e.mapId,a,r,t)}else w.logInvalidTargetId(e.mapId,a,t)})}#d(e,t,a){let o=e.eventsMap.getCallback(t,a);return o||(o=a=>this.#De(a,e,t),e.eventsMap.addCallback(t,o),o)}#l(e,t){const a=$.getSource(e,t.targetSourceId);if($.isDataSource(a))return a.getShapeById(t.targetId)}#De=(e,t,a)=>{let o=R.buildMapEventArgs(t.mapId,a,k.getShapeResult(e),e);t.dotNetRef.invokeMethodAsync(y.NotifyMapEvent,o),w.logNotifyFired(t.mapId,y.NotifyMapEvent,a.type)}}!function(e){e.ShapeChanged="shapechanged"}(m||(m={}));class U{static maps=new P;static layers=new O;static markers=new A;static popups=new j;static shapes=new G;static sources=new x;static styleControls=new F;static add(e,t){const a=V.getMapReference(e);a&&(C.logMessage(e,o.Trace,"AzEvents:add",t),t??=[],U.maps.add(a,t),U.layers.add(a,t),U.markers.add(a,t),U.popups.add(a,t),U.shapes.add(a,t),U.sources.add(a,t),U.styleControls.add(a,t))}static remove(e,t){const a=V.getMapReference(e);a&&(U.layers.remove(a,t),U.maps.remove(a,t),U.markers.remove(a,t),U.popups.remove(a,t),U.shapes.remove(a,t),U.sources.remove(a,t),U.styleControls.remove(a,t))}}!function(e){e.NotifyMapEventError="NotifyMapEventError",e.NotifyMapEventReady="NotifyMapEventReady",e.NotifyMapEvent="NotifyMapEvent",e.NotifyGeolocationWatch="NotifyGeolocationWatch"}(y||(y={})),function(e){e.Click="click",e.ContextMenu="contextmenu",e.DblClick="dblclick",e.MouseDown="mousedown",e.MouseMove="mousemove",e.MouseOut="mouseout",e.MouseOver="mouseover",e.MouseUp="mouseup"}(f||(f={})),function(e){e.TouchCancel="touchcancel",e.TouchEnd="touchend",e.TouchMove="touchmove",e.TouchStart="touchstart"}(h||(h={})),function(e){e.Wheel="wheel"}(M||(M={}));class V{static#Ne=new Map;static getAuthTokenCallback;static createMap(e){C.currentLevel=e?.logLevel??o.Information;const t=e.mapId;if(k.isEmptyOrNull(t))return void C.logMessage("",o.Error,"Missing mapId.",e);if(V.#Ne.has(t))return void C.logMessage(t,o.Warn,"Map already exists.");const r=V.#we(t,e.authOptions,e?.options),n=new a.Map(t,r),s=new N(e.dotNetRef,t,n);V.#Ne.set(t,s),C.logMessage(t,o.Debug,"was created."),B.add(t,e.controls),V.#Ie(s,e.events)}static getMap(e){const t=V.getMapReference(e);return t?.map}static getMapReference(e){const t=V.#Ne.get(e);return t||C.logMessage(e,o.Debug,"MapManager was not found."),t}static removeMap(e){const t=V.#Ne.get(e);t&&V.#Ne.delete(e)&&(t.clear(),C.logMessage(e,o.Debug,"was removed"))}static#we(e,t,a){let o={};a&&(a.camera?o={...o,...a.camera}:a.cameraBounds&&(o={...o,...a.cameraBounds}),a.service&&(o={...o,...a.service}),a.style&&(o={...o,...a.style}),a.userInteraction&&(o={...o,...a.userInteraction})),o.authOptions=t;const r=t.sasTokenUrl;return k.isNotEmptyOrNull(r)?o.authOptions.getToken=function(e,t,a){fetch(r).then(e=>e.text()).then(t=>e(t))}:o.authOptions.getToken=V.getAuthTokenCallback,o}static#Ie(e,t){const a=e.dotNetRef,r=e.mapId,n=e.map;n?(t??=[],n.events.addOnce(E.Ready,e=>{const s={target:"map",type:E.Error},i={target:"map",type:E.Ready};n.events.add(E.Error,e=>{const t={error:{message:e.error.message,name:e.error.name,stack:e.error.stack,cause:e.error.cause}},n=R.buildMapEventArgs(r,s,t);C.logMessage(r,o.Error,"Map error",n),a.invokeMethodAsync(y.NotifyMapEventError,n)}),U.add(r,t);const c=R.buildMapEventArgs(r,i);a.invokeMethodAsync(y.NotifyMapEventReady,c)})):C.logMessage(r,o.Error,"Cannot build events. Map not found.")}}!function(e){e.Error="error",e.Ready="ready"}(E||(E={}));class K{static getEasingNames(e){return K.#Re(e)?[]:a.animations.getEasingNames()}static async animateShape(e,t){const a=k.parseJsonString(t);"SetCoordinates"===a.action?await K.#Oe(e,a):C.logMessage(e,o.Error,"Animations.animateShape: action not supported.",a)}static async#Oe(e,t){if(K.#Re(e))return;const r=V.getMap(e);if(!r)return;const n="Animations.animateShape: ",s=r.sources.getById(t.dataSourceId);if(!s)return void C.logMessage(e,o.Error,`${n}DataSource not found.`,t);const i=t.shape.id;if($.isDataSource(s)){let r=s.getShapeById(i);if(!r)return void C.logMessage(e,o.Error,`${n}Shape not found where shapeId = '${i}'.`,t);a.animations.setCoordinates(r,t.shape.geometry.coordinates,t.animationOptions),r.addProperty("heading",t.shape.properties.heading)}else C.logMessage(e,o.Error,`${n}DataSource not found where id = '${t.dataSourceId}'.`,t)}static#Re(e){return!a.animations&&(C.logMessage(e,o.Trace,"Animations.setCoordinates: atlas.animations module not found."),!0)}}class z{static getCamera(e){const t=V.getMap(e);if(t)return t.getCamera()}static setCamera(e,t){const a=V.getMap(e);if(!a)return;let o=z.#Te(t);a.setCamera(o)}static#Te(e){let t={};return e.camera?t={...e.camera,...e.animation}:e.cameraBounds&&(t={...e.cameraBounds,...e.animation}),t}static getMapOptions(e){const t=V.getMap(e);if(t)return{mapCamera:t.getCamera(),service:t.getServiceOptions(),style:t.getStyle(),userInteraction:t.getUserInteraction()}}static setMapOptions(e,t){const a=V.getMap(e);if(!a)return;const o=z.#Te(t.camera);a.setCamera(o),t.service&&a.setServiceOptions(t.service),t.style&&a.setStyle(t.style),t.userInteraction&&a.setUserInteraction(t.userInteraction)}static getServiceOptions(e){const t=V.getMap(e);if(t)return t.getServiceOptions()}static setServiceOptions(e,t){const a=V.getMap(e);a&&a.setServiceOptions(t)}static getTraffic(e){const t=V.getMap(e);if(t)return t.getTraffic()}static setTraffic(e,t){const a=V.getMap(e);a&&a.setTraffic(t)}static getStyle(e){const t=V.getMap(e);if(t)return t.getStyle()}static setStyle(e,t){const a=V.getMap(e);a&&a.setStyle(t)}static getUserInteraction(e){const t=V.getMap(e);if(t)return t.getUserInteraction()}static setUserInteraction(e,t){const a=V.getMap(e);a&&a.setUserInteraction(t)}}class H{static async add(e,t,a,o){const r=V.getMapReference(e);if(!r)return;const n=$.getSource(r,a);n&&(t??=[],t.forEach(e=>{H.#Ae(r,e,n,o)}))}static#Ae(e,t,a,r){if(a instanceof S().source.DataSource==0)return void C.logMessage(e.mapId,o.Error,`adding feature: source with ID '${a.getId()}' is not a DataSource`);if(r&&t.id){const e=a.getShapeById(t.id);e&&a.remove(e)}let n;switch(t.geometry.type.toLowerCase()){case I.Point:n=new(S().data.Point)(t.geometry.coordinates);break;case I.MultiPoint:n=new(S().data.MultiPoint)(t.geometry.coordinates,t.bbox);break;case I.LineString:n=new(S().data.LineString)(t.geometry.coordinates,t.bbox);break;case I.Polygon:n=new(S().data.Polygon)(t.geometry.coordinates,t.bbox)}if(!n)return void C.logMessage(e.mapId,o.Error,`adding feature error: geometry type '${t.geometry.type}' not supported`);const s={...t.properties};let i=new(S().data.Feature)(n,s,t.id);if(i.jsInterop=t.jsInterop,t.asShape){let e=new(S().Shape)(i);e.jsInterop=t.jsInterop,a.add(e)}else a.add(i)}static update(e,t,a){const o=V.getMapReference(e);if(!o)return;const r=$.getDataSource(o,a);r&&t.forEach(e=>{const t=r.getShapeById(e.id);t&&(t.setCoordinates(e.geometry.coordinates),t.setProperties(e.properties))})}static getCoordinates(e,t,a){const o=V.getMapReference(e);if(!o)return;const r=$.getDataSource(o,a);if(!r)return;const n=r.getShapeById(t);return n?n.getCoordinates():void 0}static setCoordinates(e,t,a,o){const r=V.getMapReference(e);if(!r)return;const n=$.getDataSource(r,o);if(!n)return;const s=n.getShapeById(t);s&&s.setCoordinates(a)}static getProperties(e,t,a){const o=V.getMapReference(e);if(!o)return;const r=$.getDataSource(o,a);if(!r)return;const n=r.getShapeById(t);return n?n.getProperties():void 0}static setProperties(e,t,a,o,r=!1){const n=V.getMapReference(e);if(!n)return;const s=$.getDataSource(n,o);if(!s)return;const i=s.getShapeById(t);if(i)if(r)i.setProperties(a);else{let e=i.getProperties();e={...e,...a},i.setProperties(e)}}static addProperty(e,t,a,o,r){const n=V.getMapReference(e);if(!n)return;const s=$.getDataSource(n,r);if(!s)return;const i=s.getShapeById(t);i&&i.addProperty(a,o)}}!function(e){e.Point="point",e.MultiPoint="multipoint",e.LineString="linestring",e.MultiLineString="multilinestring",e.Polygon="polygon",e.MultiPolygon="multipolygon"}(I||(I={}));class J{static#Pe=new Map;static async getLocation(e){const t={position:null,error:null},a=new Promise((t,a)=>{navigator.geolocation?navigator.geolocation.getCurrentPosition(t,a,J.#Le(e)):a({code:0,message:"This device does not support geolocation."})});return await a.then(e=>{t.position=e}).catch(e=>{t.error={code:e.code,message:e.message}}),t}static async watchPosition(e,t,a,r){if(!navigator.geolocation)return null;if(J.isWatched(t))return void C.logMessage(t,o.Warn,"Geolocation.watchPosition: watch has already been added.");r??=y.NotifyGeolocationWatch;const n=navigator.geolocation.watchPosition(a=>{if(J.isWatched(t)){const o={position:a,error:null},n={mapId:t,type:b.WatchSuccess,result:o};e.invokeMethodAsync(r,n)}},a=>{const o={position:null,error:{code:a.code,message:a.message}},n={mapId:t,type:b.WatchError,result:o};e.invokeMethodAsync(r,n)},J.#Le(a));return C.logMessage(t,o.Trace,"Geolocation.watchPosition:",n),J.#Pe.set(t,n),n}static clearWatch(e){if(navigator.geolocation&&J.#Pe.has(e)){const t=J.#Pe.get(e);C.logMessage(e,o.Trace,"Geolocation.clearWatch:",t),navigator.geolocation.clearWatch(t),J.#Pe.delete(e)}}static isWatched(e){return J.#Pe.has(e)}static#Le(e){if(e){const t={};return e.enableHighAccuracy&&(t.enableHighAccuracy=e.enableHighAccuracy),e.maximumAge&&(t.maximumAge=e.maximumAge),e.timeout&&(t.timeout=e.timeout),t}}}!function(e){e.WatchSuccess="WatchSuccess",e.WatchError="WatchRrror"}(b||(b={}));class Z{static async createFromTemplate(e,t){const a=V.getMapReference(e);if(!a)return!1;if(k.isEmptyOrNull(t.id))return C.logMessage(e,o.Error,"ImageTemplateDef.id is null or empty.",t),!1;if(k.isEmptyOrNull(t.templateName))return C.logMessage(e,o.Error,"ImageTemplateDef.templateName is null or empty.",t),!1;const r=a.map;return r.imageSprite.hasImage(t.id)?(C.logMessage(e,o.Warn,"Image template already exists.",t),!1):(await r.imageSprite.createFromTemplate(t.id,t.templateName,t.color,t.secondaryColor),!0)}static hasImage(e,t){const a=V.getMapReference(e);return!!a&&a.map.imageSprite.hasImage(t)}static async add(e,t,a,o){const r=V.getMapReference(e);return!!r&&(await r.map.imageSprite.add(t,a,o),!0)}static clear(e){const t=V.getMapReference(e);if(!t)return!1;t.map.imageSprite.clear()}static getImageIds(e){const t=V.getMapReference(e);return t?t.map.imageSprite.getImageIds():[]}static remove(e,t){const a=V.getMapReference(e);if(!a)return!1;a.map.imageSprite.remove(t)}}class _{static addGroups(e,t){const a=V.getMapReference(e);a&&(t??=[],t.forEach(e=>{_.#je(a,e.layer,e.events)}))}static add(e,t,a){const o=V.getMapReference(e);o&&(t??=[],t.forEach(e=>{_.#je(o,e,a)}))}static#je(e,t,a){const r="addLayer";if(k.isEmptyOrNull(t.type))return void C.logMessage(e.mapId,o.Error,`${r}: layer type is missing`,t);const n=t.id;if(k.isEmptyOrNull(n))return void C.logMessage(e.mapId,o.Error,`${r}: layer Id is missing`,t);if(e.map.layers.getLayerById(n))return void C.logMessage(e.mapId,o.Error,`${r}: layer already exists where layer ID=${n}`,t);let s,i=t.dataSource;const c=i.id;let l;i&&k.isNotEmptyOrNull(c)&&(s=$.getSource(e,c,!1),s||(W.add(e.mapId,[i],a),s=$.getSource(e,c),s||C.logMessage(e.mapId,o.Error,`${r}: Unable to create datasource.`,i)));const d=t.options||{};switch(t.type){case"Bubble":l=new(S().layer.BubbleLayer)(s,n,d);break;case"HeatMap":l=new(S().layer.HeatMapLayer)(s,n,d);break;case"Image":l=new(S().layer.ImageLayer)(d,n);break;case"Line":l=new(S().layer.LineLayer)(s,n,d);break;case"Polygon":l=new(S().layer.PolygonLayer)(s,n,d);break;case"PolygonExtrusion":l=new(S().layer.PolygonExtrusionLayer)(s,n,d);break;case"Symbol":_.#We(e.mapId,d),l=new(S().layer.SymbolLayer)(s,n,d);break;case"Tile":l=new(S().layer.TileLayer)(d,n)}let p=!1;l&&(l.jsInterop=t.jsInterop,a&&U.layers.add(e,a,l),e.map.layers.add(l,t.before),p=!0),p?C.logMessage(e.mapId,o.Trace,`${r}: layer added:`,t):C.logMessage(e.mapId,o.Error,`${r}: layer type '${t.type}' is not supported.`,t)}static remove(e,t){let a=[];t.forEach(e=>{a.push(e.id)}),_.removeById(e,a),a=[],t.forEach(e=>{e.dataSource&&k.isNotEmptyOrNull(e.dataSource.id)&&a.push(e.dataSource.id)}),W.removeById(e,a)}static removeById(e,t){const a=V.getMapReference(e);if(!a)return;const r="removeLayer";t.forEach(t=>{const n=a.map.layers.getLayerById(t);n?(a.map.layers.remove(n),C.logMessage(e,o.Debug,`${r}: layer with id '${t}' was removed.`)):C.logMessage(e,o.Warn,`${r}: layer with id '${t}' was not found.`)})}static getOptions(e,t){const a=V.getMapReference(e);if(!a)return;const r=a.map.layers.getLayerById(t);if(!r)return void C.logMessage(e,o.Error,`AzLayers.getOptions: layer does not exist where layer ID=${t}`);let n=r.getOptions();return n.source=null,n}static setOptions(e,t){const a=V.getMapReference(e);if(!a)return;const r=a.map.layers.getLayerById(t.id);if(!r)return void C.logMessage(e,o.Error,`AzLayers.setOptions: layer does not exist where layer ID=${t.id}`,t);let n=t.options||{};"Symbol"===t.type&&_.#We(e,n);const s={...r.getOptions(),...n};C.logMessage(e,o.Trace,"Layers.setOptions",n,s),r.setOptions(s)}static#We(e,t){const a=t.iconOptions;if(!a)return;const r=a.imageId;k.isNotEmptyOrNull(r)&&(a.image=r);const n=a.rotationSpecification;n&&(a.rotation=n),C.logMessage(e,o.Trace,"resolveSymbolLayerOptions:",t)}}class q{static fromPosition(e){return a.data.MercatorPoint.fromPosition(e)}static fromPositions(e){return a.data.MercatorPoint.fromPositions(e)}static toPosition(e){return a.data.MercatorPoint.toPosition(e)}static toPositions(e){return a.data.MercatorPoint.toPositions(e)}static toFloat32Array(e){return a.data.MercatorPoint.toFloat32Array(e)}static mercatorScale(e){return a.data.MercatorPoint.mercatorScale(e)}static meterInMercatorUnits(e){return a.data.MercatorPoint.meterInMercatorUnits(e)}}class Q extends V{}class X extends K{}class Y extends z{}class ee extends B{}class te extends U{}class ae extends H{}class oe extends J{}class re extends Z{}class ne extends _{}class se extends T{}class ie extends q{}class ce extends L{}class le extends W{}marqdoujAzureMapsBlazor=t})();